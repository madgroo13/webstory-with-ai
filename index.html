<!DOCTYPE html> 
<html lang="id"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>AI RPG: Complete Edition</title> 
    <link rel="stylesheet" href="css/style.css?v=1">
</head> 
<body> 
 
<!-- BG --> 
<div id="dynamic-bg" class="bg-neutral"></div> 

<!-- SETTINGS FLOATING BUTTON -->
<button id="btn-settings" onclick="openSettings()" data-i18n="btn-settings">‚öôÔ∏è API Key</button>

<!-- SETTINGS MODAL -->
<div id="modal-settings" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <h3 data-i18n="modal-api-title">üîë Pengaturan API Key</h3>
        <p style="font-size:0.9rem; color:#aaa; margin-bottom:15px;" data-i18n="modal-api-desc">
            Masukkan API Key Google Gemini Anda untuk bermain. Key akan disimpan di browser ini.
        </p>
        <div class="input-group">
            <label data-i18n="lbl-api-key">Google Gemini API Key</label>
            <input type="password" id="input-api-key" placeholder="Paste key di sini...">
        </div>
        <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:20px;">
            <button id="btn-cancel-api" class="btn-small" onclick="closeSettings()" style="background:#444;" data-i18n="btn-cancel">Batal</button>
            <button id="btn-save-api" class="btn-small" onclick="saveApiKey()" style="background:var(--accent); color:black;" data-i18n="btn-save-api">Simpan</button>
        </div>
        <div style="margin-top:15px; font-size:0.8rem; text-align:center;">
            <a href="https://aistudio.google.com/app/apikey" target="_blank" style="color:var(--accent);" data-i18n="link-get-key">Dapatkan API Key di sini</a>
        </div>
    </div>
</div>
 
<div id="game-container"> 
    <!-- Header --> 
    <div id="header"> 
        <h1>AI RPG <span class="tag">v0.1</span></h1> 
        <div id="current-setup" style="font-size:0.8rem; opacity:0.7; margin-top:5px; font-weight:normal;"></div>
        <div class="ctrl-group"> 
            <button class="btn-small active" id="btn-toggle-inv" onclick="toggleInventoryView()" data-i18n="btn-inv">
                <span>üéí</span> Tas 
            </button> 
            <button class="btn-small" onclick="exportSave()" data-i18n="btn-save">üíæ Save</button>
            <button class="btn-small" onclick="document.getElementById('file-upload').click()" data-i18n="btn-load">üìÇ Load</button>
            <button class="btn-small" style="color:#ff8888" onclick="confirmReset()" data-i18n="btn-reset">‚ùå Reset</button>
            <input type="file" id="file-upload" style="display:none" onchange="importSave(this)"> 
        </div> 
    </div> 
 
    <!-- Status --> 
    <div id="status-bar" style="display:none"> 
        <div class="hp-container"> 
            <span style="color:var(--danger); font-weight:bold;" data-i18n="status-hp">HP</span>
            <div class="hp-bar-bg"><div id="hp-bar" class="hp-bar-fill"></div></div> 
            <span id="hp-text" style="font-size:0.8rem;">100/100</span> 
        </div> 
        <div class="stats-display" id="dynamic-stats">
            <!-- Dynamic stats will be injected here -->
        </div> 
    </div> 
 
    <!-- Output (Maximized) --> 
    <div id="output"></div> 
 
    <!-- INVENTORY AREA (Collapsible) --> 
    <div id="inventory-area" class="inv-collapsed" style="display:none;"> 
        <div class="inv-header"> 
            <span data-i18n="header-inv">Tas Penyimpanan</span>
            <button class="btn-small" onclick="toggleCraftingMode()"><span data-i18n="btn-craft-mode">Mode Crafting: </span><span id="craft-status" style="color:#666">OFF</span></button>
        </div> 
         
        <div class="inv-grid" id="inv-grid"> 
            <div class="inv-item" style="opacity:0.5; pointer-events:none;" data-i18n="inv-empty">Kosong</div>
        </div> 
 
        <!-- Crafting UI --> 
        <div id="crafting-controls"> 
            <div class="craft-slot" id="craft-slot-1" data-i18n="craft-slot-1">Pilih Item 1</div>
            <span style="color:white; font-weight:bold; font-size:1.2rem;">+</span> 
            <div class="craft-slot" id="craft-slot-2" data-i18n="craft-slot-2">Pilih Item 2</div>
            <button id="btn-craft" class="craft-btn" disabled onclick="executeCraft()" data-i18n="btn-craft-action">GABUNGKAN</button>
        </div> 
         
        <div style="text-align: center; margin-top: 10px;"> 
            <small style="color:#666; cursor:pointer;" onclick="toggleInventoryView()" data-i18n="txt-close-inv">‚ñ≤ Tutup Tas ‚ñ≤</small>
        </div> 
    </div> 
 
    <!-- Item Popup --> 
    <div id="item-actions"> 
        <button class="action-btn" onclick="handleItemAction('Gunakan')" data-i18n="btn-use">Gunakan</button>
        <button class="action-btn" onclick="handleItemAction('Lihat')" data-i18n="btn-view">Lihat</button>
        <button class="action-btn" onclick="handleItemAction('Buang')" data-i18n="btn-drop">Buang</button>
        <button class="action-btn" style="background:#444" onclick="closePopup()" data-i18n="btn-cancel">Batal</button>
    </div> 
 
    <!-- Input Area --> 
    <div id="input-area" style="display:none"> 
        <div id="input-row"> 
            <input type="text" id="user-input" placeholder="Tulis aksi..." autocomplete="off" data-i18n="input-placeholder">
            <button class="btn-action" onclick="submitAction()" data-i18n="btn-go">Go</button>
        </div> 
        <div id="choice-container"></div> 
        <div id="dice-container"> 
            <div style="font-size:0.9rem; color:var(--text-muted)"><span data-i18n="txt-skill-check">SKILL CHECK:</span> <span id="check-reason" style="color:var(--warning)">???</span></div>
            <div class="dice-box" id="dice-box" onclick="rollDice()">D20</div> 
            <div style="font-size:0.8rem; color:#aaa" data-i18n="txt-tap-dice">Ketuk dadu</div>
        </div> 
    </div> 
 
    <!-- Screen: Language Selection -->
    <div id="screen-language" class="screen-overlay" style="display:flex;">
        <h2 class="screen-title">SELECT LANGUAGE</h2>
        <p style="color:#aaa; margin-bottom:20px;">Ketik bahasa yang Anda inginkan untuk cerita.</p>
        <div style="display:flex; flex-direction:column; gap:10px; align-items:center;">
            <input type="text" id="input-language" placeholder="Indonesia, English, Jawa, Sunda..."
                   style="padding:10px 20px; border-radius:30px; border:none; width:250px; text-align:center;">
            <button class="big-btn" onclick="submitLanguageSelection()">LANJUT / NEXT</button>
        </div>
    </div>

    <!-- Screen: Setup World (Genre & Theme) -->
    <div id="screen-menu" class="screen-overlay" style="display:none">
        <h2 class="screen-title" data-i18n="screen-setup-title">SETUP DUNIA</h2>
         
        <div style="width:100%; display:flex; flex-direction:column; gap:20px;">
            <!-- Genre -->
            <div style="width:100%; display:flex; flex-direction:column; align-items:center;">
                <div class="section-header" data-i18n="header-genre">1. PILIH GAYA BERMAIN (MAX 3)</div>
                <div class="mechanics-grid" id="genre-list"></div>
            </div>

            <!-- Theme -->
            <div style="width:100%; display:flex; flex-direction:column; align-items:center;">
                <div class="section-header" data-i18n="header-theme">2. PILIH TEMA DUNIA (MAX 3)</div>
                <div class="theme-grid" id="theme-list"></div>
            </div>
        </div>
 
        <button id="btn-next" class="big-btn" disabled onclick="handleMenuNext()" data-i18n="btn-next-setup">LANJUT -></button>
    </div> 
 
    <div id="screen-char" class="screen-overlay" style="display:none"> 
        <h2 class="screen-title" data-i18n="screen-char-title">KARAKTER</h2>

        <!-- AI Generated Form -->
        <div id="ai-char-form" style="width:100%; max-width:600px; display:flex; flex-direction:column; gap:15px;"></div>
         
        <div class="input-group" style="margin-top:20px;"> 
            <label data-i18n="lbl-char-name">Nama Karakter</label>
            <input type="text" id="char-name" value="Hero" placeholder="Name...">
        </div> 
 
        <div style="display:flex; gap:10px; width:100%; max-width:600px; justify-content: space-between;">
            <button class="big-btn" style="background:#555; flex:1;" onclick="backToSetup()" data-i18n="btn-back-setup">‚Üê KEMBALI</button>
            <button class="big-btn" style="flex:2;" onclick="startGame()" data-i18n="btn-start-game">Mulai Petualangan</button>
        </div>
    </div> 
</div> 
 
<script type="module" src="js/main.js"></script> 
</body> 
</html>
